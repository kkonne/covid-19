<!doctype html>
<html>

<head>

    <!-- essential -->
    <meta charset="utf-8">
    <title>JL & MD / COVID-19</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- favicon -->
    <link rel="shortcut icon" type="image/png" href="https://i.imgur.com/izNnSpQ.png">

    <!-- bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <link rel="stylesheet" href="./style.css" type="text/css">
</head>

<body>
    <!-- header nav-bar -->
    <div class="header" id="nav">
        <div class="container">
            <ul class="nav justify-content-center nav-fill">
                <li class="nav-item">
                    <a class="nav-link nav-fill" href="#home">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-fill" href="#by-country">By Country</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-fill disabled" href="#" tabindex="-1" aria-disabled="true">Covid-19</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-fill" href="#about">About</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-fill" href="#contact">Contact</a>
                </li>
            </ul>
        </div>
    </div>

    <!-- jumbotron -->
    <div class="main" id="home">
        <div class="jumbotron jumbotron-fluid">
            <div class="container text-center">
                <h1 class="display-4">Real-time stats</h1>
                <p class="lead">It shows current stats around the world regarding <b>Covid-19</b></p>
                <hr class="my-4">

                <div class="row">
                    <div class="col-sm-4">
                        <img src="https://i.imgur.com/VyM0OV9.png" alt="Infected">
                        <h5>Infected</h5>
                        <p>Total: <b><span id="total_infected"></span></b><br />In the last 24h: <b><span
                                    id="24h_infected"></span></b></p>
                    </div>
                    <div class="col-sm-4">
                        <img src="https://i.imgur.com/8ekUf5N.png" alt="Dead">
                        <h5><span style="color:crimson">Deaths</span></h5>
                        <p>Total: <b><span id="total_dead"></span></b><br />In the last 24h: <b><span
                                    id="24h_dead"></span></b></p>
                    </div>
                    <div class="col-sm-4">
                        <img src="https://i.imgur.com/gvRD5Oj.png" alt="Recovered">
                        <h5>Recovered</h5>
                        <p>Total: <b><span id="total_recovered"></span></b><br />In the last 24h: <b><span
                                    id="24h_recovered"></span></b></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- countries -->
    <div class="by-country" id="by-country">
        <h1 class="text-center">Data by country</h1>
        <div class="sort text-center">
            <button class="btn btn-link btn-sm"
                onclick="fetchData(method, url, sortAlphabetically)">alphabetically</button><button
                class="btn btn-link btn-sm" disabled>sort</button><button class="btn btn-link btn-sm"
                onclick="fetchData(method,url,sortByInfected)">by
                infected</button>
            <br />
        </div>

        <br />

        <div class="chart" id="chartDiv">
        </div>

        <div class="container-fluid">
            <div class="countries" id="countries">

            </div>
            <br />
        </div>
    </div>

    <!-- about -->
    <div class="about" id="about">
        <div class="container-fluid">
            <div class="container">
                <br /><br />
                <h1>About the virus</h1>
                <p>Coronavirus disease 2019 (COVID-19) is an infectious disease caused by severe acute respiratory
                    syndrome coronavirus 2 (SARS-CoV-2).</p>
                <hr class="my-4" />
                <h3>Prevention</h3>
                <p>Preventive measures to reduce the chances of infection include <b>staying at home</b>,
                    <b>avoiding crowded
                        places</b>, <b>washing hands with soap and water</b> often and for at least 20 seconds,
                    practising good
                    respiratory hygiene and <b>avoiding touching the eyes, nose or mouth</b> with unwashed hands.
                </p>
                <p>The CDC recommends covering the mouth and nose with a tissue when coughing or sneezing and
                    recommends using the inside of the elbow if no tissue is available. They also recommend
                    proper hand hygiene after any cough or sneeze.<br /> Social distancing strategies aim to reduce
                    contact of infected persons with large groups by closing schools and workplaces, restricting
                    travel and cancelling mass gatherings. Distancing guidelines also includes that <b>people stay
                        at
                        least 2 m apart</b>.</p>

                <div class="row">
                    <div class="col-sm-4 text-center">
                        <img src="https://i.imgur.com/5rHqqGE.png" alt="Mask">
                        <h6>Wear masks</h6>
                    </div>
                    <div class="col-sm-4 text-center">
                        <img src="https://i.imgur.com/9Co9aZB.png" alt="Washing hands">
                        <h6>Wash your hands</h6>
                    </div>
                    <div class="col-sm-4 text-center">
                        <img src="https://i.imgur.com/Je7dHMu.png" alt="Cough">
                        <h6>Cover your cough</h6>
                    </div>
                </div>
                <br />

                <h3>Signs and Symptoms</h3>
                <p>Common symptoms include fever, cough and shortness of breath. Other symptoms may include fatigue,
                    muscle pain, diarrhea, sore throat, loss of smell and abdominal pain.
                </p>
                <p>Emergency symptoms include <strong>difficulty breathing, persistent chest pain or
                        pressure,
                        confusion,
                        difficulty waking and bluish face or lips</strong>; <b>immediate medical attention is
                        advised
                        if these
                        symptoms are present</b>.</p>
                <p>Less commonly, upper respiratory symptoms, such as sneezing, runny
                    nose or sore throat may be seen. Symptoms such as nausea, vomiting and diarrhoea have been
                    observed in varying percentages.<br />There were reports indicating that loss of
                    the
                    sense of smell (anosmia) may be a common symptom among those who have mild disease, although not
                    as common as initially reported.<br />
                </p>
                <p>Those infected with the virus may be asymptomatic or develop flu-like symptoms, including
                    fever,
                    cough, fatigue and shortness of breath.<br />
                    The time from
                    exposure to onset of symptoms is typically around five days, but may range from two to 14 days.
                </p>


                <br />
                <div class="row semi-columns">
                    <div class="col-sm-6">
                        <h3>Transmission</h3>

                        <p>The WHO says it is primarily <b>spread
                                during
                                close
                                contact</b>
                            and by small droplets produced when people cough, sneeze or talk; with close contact
                            being within
                            1–3 m.</p>
                        <p>While these droplets are produced when breathing out, they usually fall to the ground or
                            surfaces rather than spread through the air over large distances.<br />People may also
                            become infected by touching a contaminated surface and then their face. The virus can
                            survive on surfaces for up to 72 hours.</p>
                        <p>Some details about how the disease is spread are still being determined.</p>
                    </div>
                    <div class="col-sm-6">
                        <h3>Origin</h3>
                        <p>The origin is unknown but by December 2019 the spread of infection was
                            almost entirely driven by human-to-human transmission.</p>
                        <p>The virus is thought to be natural and have an animal origin, through spillover
                            infection. The earliest reported
                            infection has been unofficially reported to have occurred on 17 November 2019 in Wuhan,
                            China. A study of the first 41 cases of confirmed COVID-19, published in January
                            2020 in The Lancet, revealed the earliest date of onset of symptoms as 1 December
                            2019.</p>
                        <p>Official publications from the WHO reported the earliest onset of
                            symptoms as 8 December 2019.</p>
                    </div>
                </div>
                <br />


                <h3>Diagnosis</h3>
                <p>The WHO has published several testing protocols for the disease.</p>
                <p>The standard method of testing is real-time reverse transcription polymerase chain reaction
                    (rRT-PCR).<br />The test is typically done on respiratory samples obtained by a
                    nasopharyngeal
                    swab, however a nasal swab or sputum sample may also be used.</p>

                <div class="who-button">
                    <a href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019" target="_blank"
                        alt="WHO Covid-19 Website"><button class="btn btn-dark">WHO Covid-19
                            Website</button></a>
                </div>
            </div>
        </div>
    </div>

    <!-- footer -->
    <div class="footer" id="contact">
        <div class="footer-columns">
            <div class="container">
                <div class="row">
                    <div class="col-sm-3 text-center">
                        <p><strong>Josip Leko</strong></p>
                        <p>Tel: +387 63 121-969</p>
                        <p>josipleko@mail.com</p>
                        <a href="https://www.instagram.com/josip.leko/" target="_blank"><img
                                src="https://i.imgur.com/ca4JBpj.png" class="mr-3" alt="Josip's Instagram Profile"></a>
                        <a href="https://www.facebook.com/josip.leko.39" target="_blank"><img
                                src="https://i.imgur.com/3wKKCUc.png" class="mr-3" alt="Josip's Facebook Profile"></a>
                        <a href="https://www.linkedin.com/in/josip-leko-00284219a" target="_blank"><img
                                src="https://i.imgur.com/TcGC8pG.png" class="mr-3" alt="Josip's LinkedIn Profile"></a>
                    </div>
                    <div class="col-sm-3 text-center">
                        <p><strong>Mario Duspara</strong></p>
                        <p>Tel: +387 63 117-282</p>
                        <p>duspara777@hotmail.com</p>
                        <a href="https://www.instagram.com/dule777/" target="_blank"><img
                                src="https://i.imgur.com/ca4JBpj.png" class="mr-3" alt="Mario's Instagram Profile"></a>
                        <a href="https://www.facebook.com/Dule117" target="_blank"><img
                                src="https://i.imgur.com/3wKKCUc.png" class="mr-3" alt="Mario's Facebook Profile"></a>
                        <a href="https://www.linkedin.com/in/mario-duspara-4500a41a1/" target="_blank"><img
                                src="https://i.imgur.com/TcGC8pG.png" class="mr-3" alt="Mario's LinkedIn Profile"></a>
                    </div>
                    <div class="col-sm-3 text-center">
                        <p><strong>Hrvoje Grubišić</strong></p>
                        <a href="https://www.instagram.com/hrvojegrubisic/" target="_blank"><img
                                src="https://i.imgur.com/ca4JBpj.png" class="mr-3" alt="Hrvoje's Instagram Profile"></a>
                        <a href="https://www.facebook.com/https://www.facebook.com/hrvoje.h.grubisic" target="_blank"><img
                                src="https://i.imgur.com/3wKKCUc.png" class="mr-3" alt="Hrvoje's Facebook Profile"></a>
                        <a href="#" target="_blank"><img
                                src="https://i.imgur.com/TcGC8pG.png" class="mr-3" alt="Hrvoje's LinkedIn Profile"></a>
                    </div>
                    <div class="col-sm-3 text-center">
                        <p><strong>SUM</strong></p>
                        <p>Tel: +387 36 337-070</p>
                        <p>Fax: +387 36 320-885</p>
                        <a href="https://www.sum.ba/" target="_blank"><img src="https://i.imgur.com/ogVRxqr.png"
                                class="mr-3" alt="Sveučilište u Mostaru"></a>
                    </div>

                </div>
            </div>
        </div>
        <div class="copyright">
            <div class="container-fluid">
                <p class="align-middle">© FPMOZ 2020, All Rights Reserved</p>
            </div>
        </div>
    </div>

    <!-- scroll up button -->
    <a href="#nav">
        <button class="btn btn-secondary" id="myBtn" title="Go to top">
            <svg class="bi bi-arrow-up-short" width="25px" height="25px" viewBox="0 0 16 16" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M8 5.5a.5.5 0 01.5.5v5a.5.5 0 01-1 0V6a.5.5 0 01.5-.5z"
                    clip-rule="evenodd" />
                <path fill-rule="evenodd"
                    d="M7.646 4.646a.5.5 0 01.708 0l3 3a.5.5 0 01-.708.708L8 5.707 5.354 8.354a.5.5 0 11-.708-.708l3-3z"
                    clip-rule="evenodd" />
            </svg>
        </button>
    </a>

    <!-- chart js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>

    <!-- JAVASCRIPT-->
    <script>
        const url = 'https://api.covid19api.com/summary';
        const method = "GET";


        let fetchData = (method, url, callback) => {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    callback(JSON.parse(this.responseText));
                };
            };
            xhttp.open(method, url, true);
            xhttp.send();
        }

        let getJumbotronData = (parsedData) => {
            document.getElementById('total_infected').innerHTML = Number(parsedData.Global.TotalConfirmed).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            document.getElementById('24h_infected').innerHTML = parsedData.Global.NewConfirmed.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            document.getElementById('total_dead').innerHTML = parsedData.Global.TotalDeaths.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            document.getElementById('24h_dead').innerHTML = parsedData.Global.NewDeaths.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            document.getElementById('total_recovered').innerHTML = parsedData.Global.TotalRecovered.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            document.getElementById('24h_recovered').innerHTML = parsedData.Global.NewRecovered.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        };

        let sortAlphabetically = (parsedData) => {
            /*
            let searchBarHTML = `<input class="form-control mr-sm-2 searchInput" type="search" id="searchInput" placeholder=" Search your country" aria-label="Search">`;
            document.getElementById('searchBar').innerHTML = searchBarHTML;
            */

            let keys = Object.values(parsedData.Countries),
                rowCounter = 0,
                content = "";
            content += `<div class="row">`;


            for (let key of keys) {
                rowCounter++;

                content += `<div class="col-md-2">
                                <div class="card" id="${key.Slug} ${key.Country}">
                                    <div class="card-body" id="${key.CountryCode}-cardBody">
                                        <h6 class="card-subtitle mb-2 text-muted float-right">${key.CountryCode}</h6>
                                        <img src="https://www.countryflags.io/${(key.CountryCode).toLowerCase()}/shiny/64.png" alt="${key.Country}'s flag">
                                        <h5 class="card-title">${key.Country}</h5>
                                        <p class="card-text">Infected: ${key.TotalConfirmed.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")}
                                            <br /><span style="color:red">Deaths</span>: ${key.TotalDeaths.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")}
                                            <br/>Recovered: ${key.TotalRecovered.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")}</p>
                                            <button class="btn btn-link btn-sm" onclick="expandButton('${key.CountryCode}')" id="${key.CountryCode}-expand">Expand info</button>
                                    </div>
                                </div>
                            </div>`;

                if (rowCounter > 5) {
                    content += `</div><div class="row">`;
                    rowCounter = 0;
                };
            };


            content += `</div>`;
            document.getElementById('countries').innerHTML = content;
            document.getElementById('chartDiv').innerHTML = "";
        };

        let quickSort = (array) => {
            if (array.length < 2) {
                return array
            };
            const chosenIndex = array.length - 1
            const chosen = array[chosenIndex][0]
            const a = []
            const b = []
            for (let i = 0; i < chosenIndex; i++) {
                const temp = array[i]
                temp[0] < chosen ? a.push(temp) : b.push(temp)
            };

            const output = [...quickSort(a), chosen, ...quickSort(b)]
            // console.log(output.join(' '))
            return output
        };

        let bubbleSort = (array) => {
            let n = array.length;
            for (let i = 0; i < n; i++) {
                for (let j = 0; j < n - 1; j++) {
                    if (array[j][0] > array[j + 1][0]) {
                        let temp = array[j];
                        array[j] = array[j + 1];
                        array[j + 1] = temp;
                    };
                };
            };

            return array;
        };

        let scrollFunction = () => {
            mybutton = document.getElementById("myBtn");
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                mybutton.style.display = "block";
            } else {
                mybutton.style.display = "none";
            };
        };

        let sortByInfected = (parsedData) => {
            fetchData(method, url, createChart);

            let keys = Object.values(parsedData.Countries),
                infectedArray = [];
            for (let key of keys) {
                infectedArray.push([key.TotalConfirmed, key.CountryCode]);
            };
            infectedArray = bubbleSort(infectedArray).reverse();


            let content = "",
                rowCounter = 0;
            content += `<div class="row">`;
            for (let i = 0; i < infectedArray.length; i++) {
                for (let key of keys) {
                    if (infectedArray[i][1] == key.CountryCode && infectedArray[i][0] > 0) {
                        rowCounter++;

                        content += `<div class="col-md-2">
                                <div class="card country-card" id="${key.Slug}">
                                    <div class="card-body" id="${key.CountryCode}-cardBody">
                                        <h6 class="card-subtitle mb-2 text-muted float-right">${key.CountryCode}</h6>
                                        <img src="https://www.countryflags.io/${(key.CountryCode).toLowerCase()}/shiny/64.png" alt="${key.Country}'s flag">
                                        <h5 class="card-title">${key.Country}</h5>
                                        <p class="card-text">Infected: ${key.TotalConfirmed.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")}
                                            <br /><span style="color:red">Deaths</span>: ${key.TotalDeaths.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")}
                                            <br/>Recovered: ${key.TotalRecovered.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")}</p>
                                            <button class="btn btn-link btn-sm" onclick="expandButton('${key.CountryCode}')" id="${key.CountryCode}-expand">Expand info</button>
                                    </div>
                                </div>
                            </div>`;

                        if (rowCounter > 5) {
                            content += `</div><div class="row">`;
                            rowCounter = 0;
                        };
                    };
                };

            };
            content += `</div>`;
            document.getElementById('countries').innerHTML = content;
        };

        let expandButton = (myCountryCode) => {

            document.getElementById(`${myCountryCode}-expand`).style.display = "none";

            let content = "";
            fetch(url)
                .then(res => res.json())
                .then(data => {
                    let keys = Object.values(data.Countries);
                    for (let key of keys) {
                        if (key.CountryCode == myCountryCode) {
                            content = `<p class="card-text"><span class="small"><b>In last 24h</b></span><br />Infected: ${key.NewConfirmed.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")}
                                <br /><span style="color:red">Deaths</span>: ${key.NewDeaths.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")}
                                <br />Recovered: ${key.NewRecovered.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")}</p>`;
                            document.getElementById(myCountryCode + '-cardBody').innerHTML += content;
                        };

                    };
                });
        };

        let createChart = (parsedData) => {
            const chartHTML = `<canvas class="text-center" id="myChart" width="100%">\n</canvas>`;
            document.getElementById('chartDiv').innerHTML = chartHTML;

            let topFiveArray = getTop5(parsedData);
            let ctx = document.getElementById('myChart').getContext('2d');
            let chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [`${topFiveArray[0][1]}`, `${topFiveArray[1][1]}`, `${topFiveArray[2][1]}`, `${topFiveArray[3][1]}`, `${topFiveArray[4][1]}`],
                    datasets: [{
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.6)',
                            'rgba(54, 162, 235, 0.6)',
                            'rgba(255, 206, 86, 0.6)',
                            'rgba(153, 102, 255, 0.6)',
                            'rgba(255, 159, 64, 0.6)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)'
                        ],
                        data: [`${topFiveArray[0][0]}`, `${topFiveArray[1][0]}`, `${topFiveArray[2][0]}`, `${topFiveArray[3][0]}`, `${topFiveArray[4][0]}`]
                    }]
                },
                options: {
                    legend: {
                        display: false,
                    }
                }
            });
        };

        let getTop5 = (parsedData) => {
            let keys = Object.values(parsedData.Countries),
                infectedArray = [];
            for (let key of keys) {
                infectedArray.push([key.TotalConfirmed, key.Country]);
            };
            infectedArray = bubbleSort(infectedArray).reverse();
            let restOfTheWorld = 0;
            for (let i = 5; i < infectedArray.length; i++) {
                restOfTheWorld += infectedArray[i][0]
            }
            infectedArray = infectedArray.slice(0, 5);
            infectedArray.push([restOfTheWorld, 'Rest of the World']);
            return infectedArray;
        };


        window.onscroll = () => { scrollFunction() };
        fetchData(method, url, getJumbotronData);
        fetchData(method, url, sortByInfected);


        /*
        APIs used:
        Covid-19 Stats: https://api.covid19api.com/
        Country flags: https://www.countryflags.io/
        */

        console.log(`Thanks for visiting our site!\nCreated by Josip Leko & Mario Duspara`);
    </script>

    <!-- bootstrap jquery, popper and js-->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>
</body>

</html>
